library(dplyr)
data <- read.csv("Iowa_Liquor_Sales.csv")
data %>% names()
str(data)
dim(data
)
data %>% summary()
## Col check
data %>%
select(Invoice.Item.Number) %>%
unique() %>% nrow()
### Category?
data %>%
select(Category.Name) %>%
unique() %>% head(20)
### Category?
data %>%
select(Category.Name) %>%
unique() %>% nrow()
## Default
data %>% names()
### duplicate check
data %>%
select(Category, Category.Name, Vendor.Number, Vendor.Name, Item.Number, Item.Description, State.Bottle.Cost, State.Bottle.Retail) %>%
unique() %>% nrow()
### duplicate check
data %>%
select(Category, Category.Name, Vendor.Number, Vendor.Name, Item.Number, Item.Description, State.Bottle.Cost) %>%
unique() %>% nrow()
data %>%
select(Item.Number) %>% nrow()
data %>%
select(Item.Number) %>% unique() %>% nrow()
data %>%
select(Item.Description) %>% unique() %>% nrow()
data %>%
select(Vendor.Number) %>% unique() %>% nrow()
data %>%
select(Vendor.Name) %>% unique() %>% nrow()
# Category
data %>%
select(Category) %>% unique() %>% nrow() #272
data %>%
select(Category.Name) %>% unique() %>% nrow() #394
# Category
data %>%
select(Category) %>%
filter(!is.na(Category)) %>% unique() %>% nrow() #108
data %>%
select(!is.na(Category.Name)) %>% unique() %>% nrow() #131
data %>%
select(Category.Name) %>%
filter(!is.na(Category.Name)) %>% unique() %>% nrow() #131
load("C:/Users/User/Desktop/R_Data/R_data/Iowa/Data/sss.RData")
library(googlesheets4)
library(tidyverse)
library(dplyr)
library(lubridate)
library(stringr)
# -----------------------------------------------------------------------------------
# Account Verification
# -----------------------------------------------------------------------------------
gs4_auth()
wdir <- 'https://docs.google.com/spreadsheets/d/1a1rbVgVJp6n6xd8r7Qxu1WTwo-9n1cnzd_7lk7FX6fM/'
### Data;
setwd("./Data")
out.sheet <- gs4_get(wdir)
data2019 %>%
select(Store.Name) %>% table() %>% head()
data2019 %>% head(200) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Store.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Name, .keep_all = T), by = "Store.Name") %>%
arrange(Store.Number, Date) %>% head(10)
data2019 %>% head(500) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Store.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Name, .keep_all = T), by = "Store.Name") %>%
arrange(Store.Number, Date) %>% head(10)
data2019 %>% head(500) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>% nrow()
data2019 %>% head(10000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>% nrow()
data2019 %>% head(10000) %>%
select(Store.Number, Store.Name) %>%
unique() %>% nrow()
data2019 %>% head(30000) %>%
select(Store.Number, Store.Name) %>%
unique() %>% nrow()
data2019 %>% head(30000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>% nrow()
data2019 %>% tail(30000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>% nrow()
data2019 %>% tail(30000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>% nrow()
data2019 %>% tail(30000) %>%
select(Store.Number, Store.Name) %>%
unique() %>% nrow()
data2019 %>% tail(30000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>% head(10)
data2019 %>% tail(100000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>% head(10)
data2019 %>% tail(100000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>% nrow()
data2019 %>% tail(100000) %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Store.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Name, .keep_all = T), by = "Store.Name") %>%
arrange(Store.Number, Date) %>% head(10)
data2019 %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Store.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Name, .keep_all = T), by = "Store.Name") %>%
arrange(Store.Number, Date) %>%
sheet_write(out.sheet,
sheet = 'Check_Store')
wdir <- 'https://docs.google.com/spreadsheets/d/1a1rbVgVJp6n6xd8r7Qxu1WTwo-9n1cnzd_7lk7FX6fM/'
# -----------------------------------------------------------------------------------
# Account Verification
# -----------------------------------------------------------------------------------
gs4_auth()
data2019 %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Store.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Name, .keep_all = T), by = "Store.Name") %>%
arrange(Store.Number, Date) %>%
sheet_write(out.sheet,
sheet = 'Check_Store')
data2019 %>%
select(Vendor.Number, Vendor.Name, Date) %>%
unique() %>%
group_by(Vendor.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Vendor.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Vendor.Name, .keep_all = T), by = "Vendor.Name") %>%
arrange(Vendor.Number, Date) %>%
sheet_write(out.sheet,
sheet = 'Check_Vendor')
data2019 %>%
select(Vendor.Number, Vendor.Name) %>%
unique() %>%
group_by(Vendor.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Vendor.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Vendor.Name, .keep_all = T), by = "Vendor.Name") %>%
arrange(Vendor.Number, Date) %>%
sheet_write(out.sheet,
sheet = 'Check_Vendor')
data2019 %>%
select(Store.Name) %>% unique() %>% nrow() #2563
### Normalization Check
# Store -> Need Check
data2019 %>%
select(Store.Number) %>% unique() %>% nrow() #2465
2563-2465
check_store <- read_sheet(wdir,
sheet = 'Check_Store',
col_names = T, na = '')
check_vendor <- read_sheet(wdir,
sheet = 'Check_Vendor',
col_names = T, na = '')
read_sheet(wdir,
sheet = 'Check_Store',
col_names = T, na = '') %>%
select(-4, -5) %>%
filter(check == 1) %>% nrow()
check_store <- read_sheet(wdir,
sheet = 'Check_Store',
col_names = T, na = '') %>%
select(-4, -5) %>%
filter(check == 1)
check_vendor <- read_sheet(wdir,
sheet = 'Check_Vendor',
col_names = T, na = '') %>%
select(-4, -5) %>%
filter(check == 1)
data2019 %>% head(10000) %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow()
data2019 %>% head(10000) %>%
select(Vendor.Number, Vendor.Name) %>% unique() %>% nrow()
mutate(Store.Name = ifelse(Store.Number %in% as.vector(check_store$Store.Number),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.vector(check_vendor$Vendor.Number),
check_vendor$Vendor.Name, Vendor.Name))
data2019 %>% names()
mutate(Store.Name = ifelse(Store.Number %in% as.list(check_store$Store.Number),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.list(check_vendor$Vendor.Number),
check_vendor$Vendor.Name, Vendor.Name))
mutate(Store.Name = ifelse(Store.Number %in% check_store[,1],
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% check_vendor[,1],
check_vendor$Vendor.Name, Vendor.Name))
class(check_store[,1])
x <- check_store[,1]
x <- as.vector(check_store[,1])
mutate(Store.Name = ifelse(Store.Number %in% as.vector(check_store[,1]),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.vector(check_vendor[,1]),
check_vendor$Vendor.Name, Vendor.Name))
### Change duplicated Store, Vendor Names
test <- data2019 %>% head(10000) %>%
mutate(Store.Name = ifelse(Store.Number %in% as.vector(check_store[,1]),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.vector(check_vendor[,1]),
check_vendor$Vendor.Name, Vendor.Name))
test %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow()
test %>%
select(Vendor.Number, Vendor.Name) %>% unique() %>% nrow()
### Change duplicated Store, Vendor Names
test <- data2019 %>%
mutate(Store.Name = ifelse(Store.Number %in% as.vector(check_store[,1]),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.vector(check_vendor[,1]),
check_vendor$Vendor.Name, Vendor.Name))
test %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow()
test %>%
select(Vendor.Number, Vendor.Name) %>% unique() %>% nrow()
data2019 %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow()
data2019 %>%
select(Vendor.Number, Vendor.Name) %>% unique() %>% nrow()
View(check_store)
### Normalization Check
# Store -> Need Check
data2019 %>%
select(Store.Number) %>% unique() %>% nrow() #2465
data2019 %>%
select(Store.Name) %>% unique() %>% nrow() #2563
data2019 %>%
select(Store.Name, Store.Number) %>% unique() %>% nrow() #2563
check_store <- read_sheet(wdir,
sheet = 'Check_Store',
col_names = T, na = '') %>%
select(-4, -5) %>%
filter(check == 1)
### Change duplicated Store, Vendor Names
test <- data2019 %>%
mutate(Store.Name = ifelse(Store.Number %in% as.vector(check_store[,1]),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.vector(check_vendor[,1]),
check_vendor$Vendor.Name, Vendor.Name))
### count
test %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow() #2656
check_store <- read_sheet(wdir,
sheet = 'Check_Store',
col_names = T, na = '') %>%
unique() %>%
select(-4, -5) %>%
filter(check == 1)
data2019 %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow()
data2019 %>%
select(Store.Name, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Name, .keep_all = T) %>% nrow()
data2019 %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Store.Number, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Number, .keep_all = T), by = "Store.Number") %>%
arrange(Store.Number, Date) %>%
sheet_write(out.sheet,
sheet = 'Check_Store2')
data2019 %>%
select(Store.Number) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
left_join(data2019 %>%
select(Store.Number, Date) %>%
arrange(desc(Date)) %>%
distinct(Store.Number, .keep_all = T), by = "Store.Number") %>%
arrange(Store.Number, Date) %>%
sheet_write(out.sheet,
sheet = 'Check_Store2')
data2019 %>%
select(Store.Number, Store.Name) %>%
unique() %>%
group_by(Store.Number) %>%
mutate(n = n()) %>%
filter(n > 1) %>% nrow()
### Change duplicated Store, Vendor Names
test <- data2019 %>%
mutate(Store.Name = ifelse(Store.Number %in% as.vector(check_store[,1]),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.vector(check_vendor[,1]),
check_vendor$Vendor.Name, Vendor.Name))
### count
test %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow() #2656
data2019 %>%
mutate(Store.Name = ifelse(Store.Number %in% as.vector(check_store[,1]),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% as.vector(check_vendor[,1]),
check_vendor$Vendor.Name, Vendor.Name)) %>%
filter(Store.Number == 4418)
check_store[,1] %>% head()
length(as.vector(check_store[,1]))
length(as.list(check_store[,1]))
length(check_store[,1])
length(c(check_store$Store.Number))
### Change duplicated Store, Vendor Names
test <- data2019 %>%
mutate(Store.Name = ifelse(Store.Number %in% c(check_store$Store.Number),
check_store$Store.Name, Store.Name)) %>%
mutate(Vendor.Name = ifelse(Vendor.Number %in% c(check_vendor$Vendor.Number),
check_vendor$Vendor.Name, Vendor.Name))
### count
test %>%
select(Store.Number, Store.Name) %>% unique() %>% nrow() #2656?
c(check_store$Store.Number) %>% head()
c(check_store$Store.Number) %>% head(20)
View(check_store)
View(check_vendor)
